{% extends "baseLayout.html" %}
{% block title %}Save the bees!{% endblock %}
{% block head %}
  {{ super() }}
{% endblock %}

{% block content %}
    <div class="data-box">
        <div class="header">
            <div>
                <h4>Temperature</h4>
                <p>current temperature</p>
                <var>{{ currentTemp }}<span>â„ƒ</span></var>
                <a href="/"><i class="fas fa-bars"></i></a>
            </div>
            <div>
                <h4>Humidity</h4>
                <p>current humidity</p>
                <var>{{ currentHumidity }}<span>%</span></var>
                <a href="/"><i class="fas fa-bars"></i></a>
            </div>
        </div>
        <div class="footer">
            <div class="header">
                <h2>TEMPERATURE/HUMIDITY CURVE</h2>
                <select id="timelinePicker" selected="day">
                    <option value="day">Day</option>
                    <option value="week">Week</option>
                    <option value="month">Month</option>
                    <option value="year">Year</option>
                </select>
                <time>From Nov 2021 to Apr 2022</time>
            </div>
            <div class="main">
                <div>
                    <div></div><span>Temperature</span>
                </div>
                <div>
                    <div></div><span>Humidity</span>
                </div>
            </div>
            <div class="footer">
                <canvas id="chart" style="position: center; height: 20vh; width: 60vw"></canvas>
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <script>
                	var temperature = [];
                	var dailyLabels = [
						  {% for item in dailyLabels %}
							"{{ item }}",
						  {% endfor %}];
					var weeklyLabels = [
						  {% for item in weeklyLabels %}
							"{{ item }}",
						  {% endfor %}];
					var monthlyLabels = [
						  {% for item in monthlyLabels %}
							"{{ item }}",
						  {% endfor %}];
					var yearlyLabels = [
						  {% for item in yearlyLabels %}
							"{{ item }}",
						  {% endfor %}];

                	var tempDaily = [
                		{% for temp in dailyTempValues %}
							{{ temp }},
						{% endfor %}];
					var tempWeekly = [
                		{% for temp in weeklyTempValues %}
							{{ temp }},
						{% endfor %}];
					var tempMonthly = [
                		{% for temp in monthlyTempValues %}
							{{ temp }},
						{% endfor %}];
					var tempYearly = [
                		{% for temp in yearlyTempValues %}
							{{ temp }},
						{% endfor %}];

					var humidityDaily = [
							{% for humidity in dailyHumidityValues %}
							  {{ humidity }},
							{% endfor %}];
					var humidityWeekly = [
							{% for humidity in weeklyHumidityValues %}
							  {{ humidity }},
							{% endfor %}];
					var humidityMonthly = [
							{% for humidity in monthlyHumidityValues %}
							  {{ humidity }},
							{% endfor %}];
					var humidityYearly =[
							{% for humidity in yearlyHumidityValues %}
							  {{ humidity }},
							{% endfor %}];


					const data = {
					  labels: [
						  {% for item in dailyLabels %}
							"{{ item }}",
						  {% endfor %}
						],
					  datasets: [{
						label: 'Temperature',
						backgroundColor: '#bb7600',
						borderColor: '#bb7600',
						data: [
                		{% for temp in dailyTempValues %}
							{{ temp }},
						{% endfor %}],
						yAxisID: 'temp',
					  },
					  {
						label: 'Humidity',
						backgroundColor: '#bb9c00',
						borderColor: '#bb9c00',
						data: [
							{% for humidity in dailyHumidityValues %}
							  {{ humidity }},
							{% endfor %}],
						yAxisID: 'humidity',
						  }]
					};
					
					const config = {
					  type: 'line',
					  data: data,
					  options: {
						maintainAspectRatio: false,
						plugins: {
						  legend: false,
						  tooltips: { enabled: false}
						},
						scales: {
						  xAxes: {
							ticks: {
							  minRotation: 90,
							  autoSkip: true,
							  maxTicksLimit: 24
							}
						  },
						  temp: {
							  title: {
								  text: "Temperature (Celsius)",
								  display: true,
							  },
							  type: 'linear',
							  display: true,
							  display: true,
							  position: 'left',
							  ticks: {
								  max: 50,
								  min: -50,
							  },
						  },
						  humidity: {
						  	  title: {
								  text: "Humidity (%)",
								  display: true,
							  },
							  type: 'linear',
							  display: true,
							  position: 'right',
							  grid: {
								drawOnChartArea: false,
							  },
						  },
						}
					  }
					};

					const myChart = new Chart(
					  document.getElementById('chart'),
					  config
					);

					const timelineSelect = document.getElementById('timelinePicker');
					timelineSelect.addEventListener('load', (event) => {});
					timelineSelect.addEventListener('change', timelineTracker);
					function timelineTracker()
					{
						if (timelineSelect.value == 'day')
						{
							myChart.data.labels = dailyLabels;
							myChart.data.datasets[0].data = tempDaily;
							myChart.data.datasets[1].data = humidityDaily;
							myChart.update();
						}
						if (timelineSelect.value == 'week')
						{
							myChart.data.labels = weeklyLabels;
							myChart.data.datasets[0].data = tempWeekly;
							myChart.data.datasets[1].data = humidityWeekly;
							myChart.update();
						}
						if (timelineSelect.value == 'month')
						{
							myChart.data.labels = monthlyLabels;
							myChart.data.datasets[0].data = tempMonthly;
							myChart.data.datasets[1].data = humidityMonthly;
							myChart.update();
						}
						if (timelineSelect.value == 'year')
						{
							myChart.data.labels = yearlyLabels;
							myChart.data.datasets[0].data = tempYearly;
							myChart.data.datasets[1].data = humidityYearly;
							myChart.update();
						}
					}
					
                </script>
            </div>

        </div>

    </div>
<!-- colour for humidity: #bb9c00 -->
<!-- colour for temperature: #bb7600 -->
{% endblock %}

{% block footer %}{% endblock %}
